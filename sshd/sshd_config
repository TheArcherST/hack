# auth: keys only
PasswordAuthentication no
KbdInteractiveAuthentication no
ChallengeResponseAuthentication no
PubkeyAuthentication yes

PermitRootLogin no
UsePAM no

# forwarding policy: only local forwards (client->server)
AllowTcpForwarding local
GatewayPorts no
AllowAgentForwarding no
X11Forwarding no
PermitTTY no

# modern host key
HostKey /etc/ssh/ssh_host_ed25519_key
HostKeyAlgorithms ssh-ed25519
PubkeyAcceptedKeyTypes ssh-ed25519,ssh-ed25519-cert-v01@openssh.com

# restrict this user further
Match User appuser
    AllowTcpForwarding local
    ForceCommand /bin/false
